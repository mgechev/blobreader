!function(t){"use strict";function n(){var t=new ArrayBuffer(4),n=new Uint8Array(t),r=new Uint32Array(t);if(n[0]=161,n[1]=178,n[2]=195,n[3]=212,3569595041===r[0])return i.ENDIANNESS.LITTLE_ENDIAN;if(2712847316===r[0])return i.ENDIANNESS.BIG_ENDIAN;throw new Error("Unrecognized endianness")}function i(t,r,e){return this instanceof i?(this._blob=t,this._position=0,this._queue=[],this._currentEndianness=e||n(),this._dataEndianness=r||this._currentEndianness,this._pendingTask=!1,void(this._currentResult=null)):new i(t,r,e)}function r(){function t(t){n.cb(t),this._pendingTask=!1,this._position+=n.count,r.call(this)}var n=this._queue.shift();if(n){if(void 0===n.count&&(n.count=this._blob.size-this._position),this._position+n.count>this._blob.size)throw new Error("Limit reached. Trying to read "+(this._position+n.count)+" bytes out of "+this._blob.size+".");n.type||(n.type=i.BINARY_STRING);var e=this._blob.slice(this._position,this._position+n.count);if(n.type===i.BLOB)t.call(this,e);else{var o=new FileReader;this._pendingTask=!0,o.onload=function(n){t.call(this,n.target.result)}.bind(this),o.onerror=function(){throw new Error("Error while reading the blob")},o["readAs"+n.type](e)}}}function e(t,n){for(var i=0;i<t.length;i+=1)t[i]=n(t[i]);return t}function o(t,n,i,r){this._currentResult||(this._currentResult={}),n=(n||1)*i;var e=function(e){var o=8*i,u=window["Uint"+o+"Array"];e=new u(e),this._currentEndianness!==r&&(e=s["swap"+o](e)),n===i&&(e=e[0]),this._currentResult[t]=e}.bind(this);return this.readArrayBuffer(n,e)}i.ARRAY_BUFFER="ArrayBuffer",i.BINARY_STRING="BinaryString",i.TEXT="Text",i.DATA_URL="DataURL",i.BLOB="Blob",i.ENDIANNESS={BIG_ENDIAN:"BIG_ENDIAN",LITTLE_ENDIAN:"LITTLE_ENDIAN"},i.prototype.setDataEndianness=function(t){this._dataEndianness=t},i.prototype.read=function(t,n,i){return"string"==typeof t&&(i=n,t=void 0,n=t),"function"==typeof t&&(i=t,t=void 0),"function"==typeof n&&(i=n,n=void 0),this._queue.push({count:t,cb:i,type:n}),this._pendingTask||r.call(this),this},i.prototype.readText=function(t,n){return this.read(t,i.TEXT,n)},i.prototype.readArrayBuffer=function(t,n){return this.read(t,i.ARRAY_BUFFER,n)},i.prototype.readBinaryString=function(t,n){return this.read(t,i.BINARY_STRING,n)},i.prototype.readDataURL=function(t,n){return this.read(t,i.DATA_URL,n)};var s={swap8:function(t){return e(t,function(t){return t})},swap16:function(t){return e(t,function(t){return(255&t)<<8|t>>8&255})},swap32:function(t){return e(t,function(t){return(255&t)<<24|(65280&t)<<8|t>>8&65280|t>>24&255})}};i.prototype.readUint8=function(t,n,i){return o.call(this,t,n,1,i||this._dataEndianness)},i.prototype.readUint16=function(t,n,i){return o.call(this,t,n,2,i||this._dataEndianness)},i.prototype.readUint32=function(t,n,i){return o.call(this,t,n,4,i||this._dataEndianness)},i.prototype.readBlob=function(t,n){return this._queue.push({count:n,type:i.BLOB,cb:function(n){this._currentResult[t]=n}.bind(this)}),this},i.prototype.skip=function(t){return t=t||1,this._queue.push({count:t,type:i.BLOB,cb:function(){}}),this},i.prototype.commit=function(t){if(!this._currentResult)throw new Error("Cannot commit without any reads");var n=this._currentResult,r={count:0,type:i.BLOB,cb:function(){t(n),this._currentResult=null}.bind(this)};return this._queue.push(r),this},t.BlobReader=i}(window);